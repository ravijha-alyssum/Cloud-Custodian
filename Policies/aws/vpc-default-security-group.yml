# policies:
#   - name: vpc-default-sg-inbound-rules
#     resource: aws.vpc
#     comment: |
#       This policy flags default security groups that have inbound traffic rules.
#     filters:
#       - type: default-sg
#         inbound: true

policies:
  - name: aws-default-sg-has-inbound-rules
    resource: aws.security-group
    comment: |
      This policy flags default security groups that have any inbound traffic rules.
      The default SG is identified by its name being 'default'.
    filters:
      # Correctly filter for the security group whose name is 'default'
      - GroupName: "default"
      # Then, from that group, find any that have inbound rules defined
      - IpPermissions: not-empty